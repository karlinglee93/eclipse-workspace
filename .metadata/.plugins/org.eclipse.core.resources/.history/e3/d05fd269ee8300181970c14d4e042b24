package com.jdbc_test;

import java.sql.Connection;
import java.sql.SQLException;

import com.mysql.jdbc.PreparedStatement;

public class I_D_S_U {
	// 增加insert
	private static int insert(Student student) {
	    // 获取连接
		Connection conn = (Connection) Conn.getConn();
	    String sql = "insert into students (Name,Sex,Age) values(?,?,?)";

	    int i = 0;

	    // 预编译SQL，减少sql执行
	    PreparedStatement pstmt;
	    try {
	        pstmt = (PreparedStatement) conn.prepareStatement(sql);
	        // 传参
	        pstmt.setString(1, student.getName());
	        pstmt.setString(2, student.getSex());
	        pstmt.setString(3, student.getAge());
	        
	        i = pstmt.executeUpdate();
	        
	        // 执行
	        pstmt.execute();
	        
	        pstmt.close();
	        conn.close();
	    } catch (SQLException e) {
	        e.printStackTrace();
	    }
	    return i;
	}

	public static void main(String args[]) {
	    JDBCOperation.getAll();
	    JDBCOperation.insert(new Student("Achilles", "Male", "14"));
	    JDBCOperation.getAll();
	    JDBCOperation.update(new Student("Bean", "", "7"));
	    JDBCOperation.delete("Achilles");
	    JDBCOperation.getAll();
	}
}
