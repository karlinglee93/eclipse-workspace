package com.jdbc_test;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;

import com.mysql.jdbc.PreparedStatement;

public class I_D_S_U {
	private static int insert(Student student) {
	    Connection conn = getConn();
	    int i = 0;
	    String sql = "insert into students (Name,Sex,Age) values(?,?,?)";
	    PreparedStatement pstmt;
	    try {
	        pstmt = (PreparedStatement) conn.prepareStatement(sql);
	        pstmt.setString(1, student.getName());
	        pstmt.setString(2, student.getSex());
	        pstmt.setString(3, student.getAge());
	        i = pstmt.executeUpdate();
	        pstmt.close();
	        conn.close();
	    } catch (SQLException e) {
	        e.printStackTrace();
	    }
	    return i;
	}

	private static Connection getConn() {
		String driver = "com.mysql.jdbc.Driver";
		String url = "jdbc:mysql://localhost:3306/samp_db"
				+ "?useUnicode=true&characterEncoding=utf-8&useSSL=false";
		String user = "root";
		String password = "wsljn123";
		
		// 加载mysql驱动
		try {
			Class.forName(driver);
		} catch (ClassNotFoundException e) {
			// TODO Auto-generated catch block
			System.out.println("无法加载数据库驱动。");
			e.printStackTrace();
		}
		
		// 创建数据库连接
		Conn conn = null;
		try {
			conn = (Conn) DriverManager.getConnection(url, user, password);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			System.out.println("创建数据库连接出错：");
			e.printStackTrace();
		}
		if (conn == null) {
			System.out.println("无法创建数据库连接。");
		} else {
			System.out.println("数据源测试成功。");
		}
		
		return conn;
	}


}
